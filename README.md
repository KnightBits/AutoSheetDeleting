# Google Sheets Auto-Delete Columns Script

## Описание

Этот скрипт для Google Таблиц автоматически удаляет столбцы **CE** по **CI** каждый выбранный промежуток времени и записывает в ячейку **CE3** дату ближайшего будущего понедельника. Скрипт полезен для автоматической очистки данных с обновлением даты новой недели.

## Функциональность

- **Удаление столбцов CE по CI**: Скрипт удаляет столбцы с CE (83-й) по CI (87-й).
- **Запись даты ближайшего понедельника**: После удаления в ячейку CE3 записывается дата следующего понедельника (если скрипт запустится, например, в воскресенье, то запишется дата завтрашнего понедельника).

## Установка

1. Откройте вашу Google Таблицу.
2. Перейдите в меню **Расширения** -> **Apps Script**.
3. Удалите текущий код и вставьте следующий код в редактор:

   ```javascript
   function deleteColumnsCEtoCI() {
     var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
     
     // Удаляем столбцы от CE (83-й столбец) до CI (87-й столбец)
     sheet.deleteColumns(83, 5); // Удаляем 5 столбцов начиная с 83-го (CE)
     
     // Вставляем дату ближайшего понедельника в ячейку CE3
     var nextMonday = getNextMonday();
     sheet.getRange('CE3').setValue(nextMonday);
   }

   function getNextMonday() {
     var today = new Date();
     var day = today.getDay();
     
     // Определяем, сколько дней нужно прибавить, чтобы получить следующий понедельник
     var daysToNextMonday = (day === 0) ? 1 : (8 - day); // Если воскресенье, то понедельник завтра, иначе рассчитываем
     
     var nextMonday = new Date(today);
     nextMonday.setDate(today.getDate() + daysToNextMonday);
     
     // Возвращаем форматированную дату (например, DD.MM.YYYY)
     return Utilities.formatDate(nextMonday, Session.getScriptTimeZone(), "dd.MM.yyyy");
   }

   function createTrigger() {
     // Создаем триггер, который будет вызывать функцию через каждые 60 секунд (каждую минуту)
     ScriptApp.newTrigger('deleteColumnsCEtoCI')
     .timeBased()
     .everyMinutes(1) // Запуск каждую минуту
     .create();
   }
   ```

4. Сохраните проект, например, под именем "AutoDeleteColumns".
5. В меню **Триггеры** (Triggers) создайте новый триггер, используя функцию `createTrigger`, чтобы она запускалась каждый промежуток времени.

## Настройка

- **Удаляемые столбцы**: В коде используется функция `sheet.deleteColumns(83, 5)`, которая удаляет столбцы с 83-го по 87-й (CE по CI). Если нужно изменить диапазон, просто подставьте другие индексы столбцов.
- **Запись даты ближайшего понедельника**: Дата ближайшего понедельника записывается в ячейку **CE3**. Формат даты: `dd.MM.yyyy`. Можно изменить формат, если это нужно, в функции `getNextMonday()`.

## Примечания

- Скрипт запускается каждые 60 секунд, но вы можете изменить его расписание, настроив другой интервал в триггере (например, раз в неделю или раз в день).
- Убедитесь, что данные, которые будут удаляться, не нужны для дальнейшей работы, так как столбцы CE-CI будут удаляться при каждом запуске скрипта.
